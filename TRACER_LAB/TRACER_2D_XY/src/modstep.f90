!#####################################################!
!#                                                   #!
!# auteur : F.Voitus                                 #!
!# sujet  : Organisation de la boucle temporelle     #!
!#                                                   #!
!#####################################################!

!======================================================!
!===================== MODULE STEPO ===================!
!======================================================!

MODULE MOD_STEPO

  USE MOD_PARAM, ONLY : GXPT,GYPT,ZERO,ONE,TWO,RLX,RLY,RDX,RDY,RDT,NCASE
  USE MOD_SETUP, ONLY : PROGVAR,RHSVAR,DOMAIN

CONTAINS

  !*************************************************************************************!
  !*************************************************************************************!
  !*************************************************************************************!
  !*************************************************************************************!
  SUBROUTINE MODEL_INITIALIZATION(ST,DOM)
    
    USE MOD_SETUP,  ONLY : SET_DOMAIN_GEOMETRY,SET_INITIAL_PERTURBATION

    IMPLICIT NONE

    TYPE(PROGVAR),                    INTENT(INOUT) :: ST
    TYPE(DOMAIN),                     INTENT(INOUT) :: DOM
   
    CALL SET_DOMAIN_GEOMETRY(DOM)  
    CALL SET_INITIAL_PERTURBATION(ST,DOM,NCASE)
  
  END SUBROUTINE MODEL_INITIALIZATION
  !*************************************************************************************!
  !*************************************************************************************!
  !*************************************************************************************!
  !*************************************************************************************!
  !*************************************************************************************!
  SUBROUTINE RHS_EXP(RHS,ST0)
    
    IMPLICIT NONE

    TYPE(RHSVAR),     INTENT(OUT)   :: RHS
    TYPE(PROGVAR),    INTENT(IN)    :: ST0
    
    RHS%Q(:,:)  = ST0%Q(:,:)    
    RHS%M(:,:)  = ST0%M(:,:) 
    
  END SUBROUTINE RHS_EXP
  !********************************************************************!
  !********************************************************************!
  !********************************************************************!
  !********************************************************************!
  SUBROUTINE RHS_IMP(ST0,ST1,RHSDEP)
    
    IMPLICIT NONE

    TYPE(PROGVAR),    INTENT(OUT)   :: ST0
    TYPE(PROGVAR),    INTENT(IN)    :: ST1   
    TYPE(RHSVAR),     INTENT(IN)    :: RHSDEP
    
    ST0%M(:,:)    = RHSDEP%M(:,:)  
    ST0%Q(:,:)    = RHSDEP%Q(:,:)

    ST0%U(:,:)    = ST1%U(:,:) 
    ST0%V(:,:)    = ST1%V(:,:)
    ST0%DUDX(:,:) = ST1%DUDX(:,:)
    ST0%DVDY(:,:) = ST1%DVDY(:,:) 
    
  END SUBROUTINE RHS_IMP
  !************************************************************************************!
  !************************************************************************************!
  !************************************************************************************!
  !************************************************************************************!
  SUBROUTINE SWAPP(ST9,ST0)

    IMPLICIT NONE

    TYPE(PROGVAR),  INTENT(OUT)  :: ST9
    TYPE(PROGVAR),  INTENT(IN)   :: ST0

    ST9%U(:,:)    = ST0%U(:,:)    
    ST9%V(:,:)    = ST0%V(:,:)
    ST9%DUDX(:,:) = ST0%DUDX(:,:)
    ST9%DVDY(:,:) = ST0%DVDY(:,:)
    
    ST9%Q(:,:)    = ST0%Q(:,:)                
    ST9%M(:,:)    = ST0%M(:,:)    

  END SUBROUTINE SWAPP
  !*********************************************************************************!
  !*********************************************************************************!
  !*********************************************************************************!
  !*********************************************************************************!

END MODULE MOD_STEPO
!=====================================================!
!=====================================================!
!=====================================================!
